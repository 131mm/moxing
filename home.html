<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>moxing</title>
    <script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
    <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
    <style type="text/css">
        body {font-size: 35px;  background: #ebebeb url('');padding-bottom: 30px;margin: 0; color: #001;}
        .navbar { min-height: 50px;background: #069644; color: #fff; padding: 20px; font-size: 55px; }
        img {width: 94%;text-align: center;}
        .content {padding-left: 10px;}
        .posts {height: 550px;margin-top: 5px;width: 33.3%;float: left;}
        .item {padding: 37px; border: 10px; margin: 10px; text-align: center;border-bottom: 1px solid #069644;}
        .infos {width:94%;color: #000;font-size: 20px;}
        .jump { text-align: center;font-size: 80px;clear: both;}
        .btn-pr {background: #069644;color:#ebebeb;font-size: 45px;padding: 20px 30px;border: 1px solid transparent;border-radius:10px; }
        input { border: 1px solid #ccc;font-size: 45px;width: 100px; border-radius: 10px;margin: 0px;padding: 12px;}
        a:link { text-decoration: none; color: #ec6}
        a:active { text-decoration:blink}
        a:visited { text-decoration: none;color: #069644}
    </style>
</head>
<body>
    <div id = "rep">
        <div  class="navbar" v-on:click="togle"> 
            <div id="Header">moxing</div>
        </div>
        <div v-if="hide" v-on:click="togle">
            <div  v-for="item of items">
                <div class='item'  v-on:click="reload(item.fid)">{{item.title}}</div>
            </div>
        </div>
        <div class="content">
            <div class="posts" v-for="post in infos">
                <a v-bind:href="post.href" target="_blank">
                    <div class="">
                        <img v-bind:src="post.img">
                        <div class="infos">
                        <div >{{post.title}}</div>
                        <div >回复：{{post.comments}}</div>
                        </div>
                    </div>
                </a>
            </div>
        </div>
        <div class="jump" v-if="!hide">
            <button class='btn-pr' v-on:click="next">Next: {{nextpage}}</button>
            <input class="jumpto" v-model="jump_page">
            <button class="btn-pr"  v-on:click="jump" >Go</button>
        </div>
    </div>
<script>
    var app = new Vue({
    el: '#rep',
    data () {
        return {
            infos:[],
            nextpage:null,
            next_url:null,
            pre_data:{},
            jump_page:2,
            fid:'',
            hide:true,
            items:[
                {title:'无码',fid:40},
                {title:'有码',fid:41},
                {title:'自拍',fid:43},
                {title:'动漫/二次元',fid:44},
                {title:'欧美',fid:45},
                {title:'直播',fid:46},
                {title:'写真',fid:47},
            ]
        }},
    methods:{
        togle: function(event){
            if (this.hide){this.hide=false}
            else {this.hide=true}
        },
        loadinfos: function(data){
            for (post of data.infos){
                this.infos.push(post)
            };
            this.nextpage = data.nextpage;
            this.next_url = data.next_url
        },
        next: function(event){
            this.loadinfos(this.pre_data);
            this.preload(this.next_url)
        },
        preload: function(url){
            axios.get(url).then(
                response => (this.pre_data = response.data)
            )
        },
        reload: function(fid=40,page=2){
            this.infos = [];
            this.fid = fid;
            var url = '/data?fid='+fid+'&page='+page;
            axios.get(url).then(
                response => (this.loadinfos(response.data),
                this.preload(this.next_url))                
            )
        },
        jump: function(){
            this.reload(fid=this.fid,page=this.jump_page)
        }
    }
})
</script>
<div>
    <span style="text-align: center;display:block;clear: both;">&copy;  - <a href="https://github.com/131mm/moxing"> 131mm</a></span>
</div>
</body>
</html>
